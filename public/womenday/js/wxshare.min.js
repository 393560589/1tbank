(function(win){var wxJsLibrary=function(){this.Init.apply(this,arguments)};wxJsLibrary.prototype={Init:function(){var args=Array.prototype.slice.call(arguments);if(args&&args.length>0){var config=args[0];var getType=Object.prototype.toString;if(config&&getType.call(config)=="[object Object]"){this.config=config||{url:"https://api.gongshidai.com/cj_v2/getTickte",params:{type:"caijing"},title:"分享标题",link:"分享链接",imgUrl:"分享图标",desc:"分享描述",type:"",dataUrl:"",success:"",cancel:"",error:""}}}},Render:function(){var self=this;if(self.config){var debug=false;if(typeof self.config.debug!="undefined"){debug=self.config.debug}var url=self.config.url?self.config.url:"https://api.gongshidai.com/cj_v2/getTickte";var params={};params.type=self.config.params?(self.config.params.type?self.config.params.type:"licai"):"licai";self.util.post(url,params,function(data){if(typeof data=="string"){data=eval("("+data+")")}var wxScript=document.createElement("script");wxScript.src="https://licai.gongshidai.com/wap/public/weixin/js/jweixin-1.0.0.js";wxScript.type="text/javascript";(document.head[0]||document.documentElement).appendChild(wxScript);wxScript.onload=function(){wx.config({debug:debug,appId:self.config.appId?self.config.appId:"wx2eb52f5a2f91318f",timestamp:data.timestamp,nonceStr:data.noncestr,signature:data.sign,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","onMenuShareQZone"]});wx.ready(function(){wx.onMenuShareTimeline({title:self.config.title,link:self.config.link,imgUrl:self.config.imgUrl,desc:self.config.desc,type:self.config.type?self.config.type:"link",dataUrl:self.config.dataUrl?self.config.dataUrl:"",success:function(){if(self.config.success){self.config.success.call(self)}},cancel:function(){if(self.config.cancel){self.config.cancel.call(self)}},complete:function(){if(self.config.complete){self.config.complete.call(self)}},trigger:function(){if(self.config.trigger){self.config.trigger.call(self)}}});wx.onMenuShareAppMessage({title:self.config.title,link:self.config.link,imgUrl:self.config.imgUrl,desc:self.config.desc,type:self.config.type?self.config.type:"link",dataUrl:self.config.dataUrl?self.config.dataUrl:"",success:function(){if(self.config.success){self.config.success.call(self)}},cancel:function(){if(self.config.cancel){self.config.cancel.call(self)}},complete:function(){if(self.config.complete){self.config.complete.call(self)}},trigger:function(){if(self.config.trigger){self.config.trigger.call(self)}}});wx.onMenuShareQQ({title:self.config.title,link:self.config.link,imgUrl:self.config.imgUrl,desc:self.config.desc,type:self.config.type?self.config.type:"link",dataUrl:self.config.dataUrl?self.config.dataUrl:"",success:function(){if(self.config.success){self.config.success.call(self)}},cancel:function(){if(self.config.cancel){self.config.cancel.call(self)}},complete:function(){if(self.config.complete){self.config.complete.call(self)}},trigger:function(){if(self.config.trigger){self.config.trigger.call(self)}}});wx.onMenuShareWeibo({title:self.config.title,link:self.config.link,imgUrl:self.config.imgUrl,desc:self.config.desc,type:self.config.type?self.config.type:"link",dataUrl:self.config.dataUrl?self.config.dataUrl:"",success:function(){if(self.config.success){self.config.success.call(self)}},cancel:function(){if(self.config.cancel){self.config.cancel.call(self)}},complete:function(){if(self.config.complete){self.config.complete.call(self)}},trigger:function(){if(self.config.trigger){self.config.trigger.call(self)}}});wx.onMenuShareQZone({title:self.config.title,link:self.config.link,imgUrl:self.config.imgUrl,desc:self.config.desc,type:self.config.type?self.config.type:"link",dataUrl:self.config.dataUrl?self.config.dataUrl:"",success:function(){if(self.config.success){self.config.success.call(self)}},cancel:function(){if(self.config.cancel){self.config.cancel.call(self)}},complete:function(){if(self.config.complete){self.config.complete.call(self)}},trigger:function(){if(self.config.trigger){self.config.trigger.call(self)}}})});wx.error(function(err){self.config.error.call(self,err)})}})}},util:{post:function(url,data,fn){var xhr=null;try{if(window.XMLHttpRequest){xhr=new XMLHttpRequest()}else{if(Window.ActiveXObject){xhr=new ActiveXObject("Msxml2.Xmlhttp")}}}catch(e){xhr=new ActiveXObject("Microsoft.Xmlhttp")}xhr.onreadystatechange=function(){if(this.readyState==4&&this.status==200){fn.call(this,this.responseText)}else{setTimeout(function(){xhr.abort()},1000)}};var params=this.formatParams(data);xhr.open("POST",url,true);xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xhr.send(params)},formatParams:function(data){var arr=[];for(var name in data){arr.push(name+"="+data[name])}arr.push(("v="+Math.random()).replace(".",""));return arr.join("&")}}};win.WxJsLibrary=function(paraobj){new wxJsLibrary(paraobj).Render()}})(window);